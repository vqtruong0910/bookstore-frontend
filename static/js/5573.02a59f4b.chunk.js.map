{"version":3,"file":"static/js/5573.02a59f4b.chunk.js","mappings":"kRACA,EAAiC,8B,+FCgMjC,MAjLA,WACI,IAAQA,GAAUC,EAAAA,EAAAA,MAAVD,MACR,GAAkCE,EAAAA,EAAAA,YAAlC,eAAOC,EAAP,KAAkBC,EAAlB,KACMC,GAASC,EAAAA,EAAAA,YAAW,CACtB,CACIC,SAAU,CAAC,YACXC,QAAQ,WAAD,8BAAE,yGACgBC,EAAAA,EAAAA,IAAaC,EAAAA,EAAAA,uBAD7B,cACCL,EADD,yBAEEA,EAAOM,MAFT,2CAAF,kDAAC,GAIRC,kBAAkB,EAClBC,UAAW,KAEf,CACIN,SAAU,CAAC,sBACXC,QAAQ,WAAD,8BAAE,yGACgBC,EAAAA,EAAAA,IAAaC,EAAAA,EAAAA,yBAD7B,cACCL,EADD,yBAEEA,EAAOM,MAFT,2CAAF,kDAAC,GAIRC,kBAAkB,EAClBC,UAAW,KAEf,CACIN,SAAU,CAAC,WACXC,QAAQ,WAAD,8BAAE,yGACgBC,EAAAA,EAAAA,IAAaC,EAAAA,EAAAA,QAD7B,cACCL,EADD,yBAEEA,EAAOM,MAFT,2CAAF,kDAAC,GAIRC,kBAAkB,EAClBC,UAAW,OAGnB,GAA6FC,EAAAA,EAAAA,IAAQ,CACjGC,KAAM,SACNC,cAAe,CACXC,WAAiB,OAALjB,QAAK,IAALA,GAAAA,EAAOiB,WAAP,OAAoBjB,QAApB,IAAoBA,OAApB,EAAoBA,EAAOiB,WAAa,GACpDC,SAAe,OAALlB,QAAK,IAALA,GAAAA,EAAOkB,SAAP,OAAkBlB,QAAlB,IAAkBA,OAAlB,EAAkBA,EAAOkB,SAAW,GAC9CC,UAAgB,OAALnB,QAAK,IAALA,GAAAA,EAAOmB,UAAP,OAAmBnB,QAAnB,IAAmBA,OAAnB,EAAmBA,EAAOmB,UAAY,GACjDC,UAAgB,OAALpB,QAAK,IAALA,GAAAA,EAAOoB,UAAP,OAAmBpB,QAAnB,IAAmBA,OAAnB,EAAmBA,EAAOoB,UAAY,GACjDC,aAAmB,OAALrB,QAAK,IAALA,GAAAA,EAAOqB,aAAP,OAAsBrB,QAAtB,IAAsBA,OAAtB,EAAsBA,EAAOqB,aAAe,GAC1DC,OAAa,OAALtB,QAAK,IAALA,GAAAA,EAAOsB,OAAP,OAAgBtB,QAAhB,IAAgBA,OAAhB,EAAgBA,EAAOsB,OAAS,GACxCC,SAAe,OAALvB,QAAK,IAALA,GAAAA,EAAOuB,SAAP,OAAkBvB,QAAlB,IAAkBA,OAAlB,EAAkBA,EAAOuB,SAAW,GAC9CC,QAAc,OAALxB,QAAK,IAALA,GAAAA,EAAOwB,QAAP,OAAiBxB,QAAjB,IAAiBA,OAAjB,EAAiBA,EAAOwB,QAAU,GAC3CC,QAAc,OAALzB,QAAK,IAALA,GAAAA,EAAOyB,QAAP,OAAiBzB,QAAjB,IAAiBA,OAAjB,EAAiBA,EAAOyB,QAAU,GAC3CC,cAAoB,OAAL1B,QAAK,IAALA,GAAAA,EAAO0B,cAAP,OAAuB1B,QAAvB,IAAuBA,OAAvB,EAAuBA,EAAO0B,cAAgB,GAC7DC,UAAgB,OAAL3B,QAAK,IAALA,GAAAA,EAAO2B,UAAP,OAAmB3B,QAAnB,IAAmBA,OAAnB,EAAmBA,EAAO2B,UAAY,GACjDC,QAAc,OAAL5B,QAAK,IAALA,GAAAA,EAAO4B,QAAP,OAAiB5B,QAAjB,IAAiBA,OAAjB,EAAiBA,EAAO4B,QAAU,MAd3CC,EAAR,EAAQA,SAAUC,EAAlB,EAAkBA,QAAsBC,EAAxC,EAA2BC,UAAaD,OAAUE,EAAlD,EAAkDA,aAAcC,EAAhE,EAAgEA,SAAUC,EAA1E,EAA0EA,QAASC,EAAnF,EAAmFA,MAkBnF,GAAiDC,EAAAA,EAAAA,UAAS,CACtD9B,SAAU,CAAC,kBAAmB6B,EAAM,cACpC5B,QAAQ,WAAD,8BAAE,6FACD4B,EAAM,aADL,gCAEoB3B,EAAAA,EAAAA,IAAA,UAAgBC,EAAAA,EAAAA,yBAAhB,YAAgD0B,EAAM,eAF1E,cAEK/B,EAFL,yBAGMA,EAAOM,MAHb,gCAKE,IALF,2CAAF,kDAAC,GAORC,kBAAkB,IATR0B,EAAd,EAAQ3B,KAAkB4B,EAA1B,EAA0BA,UAAWC,EAArC,EAAqCA,QAY/BC,GAAgBC,EAAAA,EAAAA,aAAW,yCAAC,WAAOC,GAAP,mFACxBC,EAAkBD,EAAEE,OAAOC,MAAM,IADT,wBAG1BZ,EAAS,UAAWU,GAHM,SAIhBT,EAAQ,WAJQ,oCAKhBY,EAAa,IAAIC,YACZC,cAAcL,GACzBG,EAAWG,UAAY,WACnB9C,EAAa2C,EAAW1C,OAC3B,EATqB,wBAUnBD,EAAa,MAVM,4CAAD,sDAY9B,IACG+C,GAAWT,EAAAA,EAAAA,aAAW,yCAAC,WAAO/B,GAAP,mFACMA,EAAvBQ,UAAciC,GADG,OACMzC,EADN,qBAGfF,EAAAA,EAAAA,IAAA,UAAgBC,EAAAA,EAAAA,eAAhB,mBAAsCV,QAAtC,IAAsCA,OAAtC,EAAsCA,EAAOqD,WAAaD,EAAM,CAAEE,QAAS,CAAE,eAAgB,yBAH9E,OAIrBC,OAAOC,MAAM,0DAJQ,gDAMrBC,QAAQC,IAAR,MACAH,OAAOC,MAAM,4DAPQ,yDAAD,sDASzB,KAEHG,EAAAA,EAAAA,YAAU,WACiB,QAAd,OAAL3D,QAAK,IAALA,OAAA,EAAAA,EAAO4B,UACPxB,EAAY,OAACJ,QAAD,IAACA,OAAD,EAACA,EAAO4B,QAE3B,GAAE,IA1FkB,gBA4FDvB,GA5FC,IA4FrB,2BAA4B,CAAC,IAAlBuD,EAAiB,QACxB,GAAIA,EAAMrB,UACN,OAAO,SAACsB,EAAA,EAAD,IAEX,GAAID,EAAMpB,QACN,OAAO,kGAEd,CAnGoB,+BAqGrB,OAAID,GACO,SAACsB,EAAA,EAAD,IAEPrB,GACO,oGAIP,kBAAMW,SAAUlB,EAAakB,GAA7B,WACI,iBAAKW,UAAU,OAAf,WACI,eAAIA,UAAU,wBAAd,oDACA,mBAAQA,UAAU,sGAAlB,kCAEJ,iBAAKA,UAAU,6DAAf,WACI,iBAAKA,UAAU,2BAAf,WACI,yDACA,SAACC,EAAA,EAAD,CAAWC,QAAQ,aAAaC,KAAK,aAAanC,QAASA,EAASoC,MAAOC,EAAAA,EAAAA,KAAeC,YAAY,oDAE1G,iBAAKN,UAAU,sCAAf,WACI,6CACA,uCAAcjC,EAAS,WAAYsC,EAAAA,EAAAA,UAAnC,IAAsDL,WAAWO,EAAAA,EAAAA,GAAKtC,EAAOb,UAAY,iBAAkBoD,EAAyB,8DAA+DC,KAAK,IAAIH,YAAY,yCACvNrC,EAAOb,WAAY,kBAAM4C,UAAU,mCAAhB,UAAoD/B,EAAOb,SAASsD,QAApE,WAExB,iBAAKV,UAAU,2BAAf,WACI,+CACA,SAACW,EAAA,EAAD,CAAYR,KAAK,WAAWnC,QAASA,EAASoC,MAAOC,EAAAA,EAAAA,OAAiBxD,KAAMN,EAAO,GAAGM,WAE1F,iBAAKmD,UAAU,2BAAf,WACI,6CACA,SAACW,EAAA,EAAD,CAAYR,KAAK,YAAYnC,QAASA,EAASoC,MAAOC,EAAAA,EAAAA,SAAmBxD,KAAMN,EAAO,GAAGM,WAE7F,iBAAKmD,UAAU,2BAAf,WACI,kDACA,SAACW,EAAA,EAAD,CAAYR,KAAK,YAAYnC,QAASA,EAASoC,MAAOC,EAAAA,EAAAA,OAAiBxD,KAAM2B,QAEjF,iBAAKwB,UAAU,2BAAf,WACI,yDACA,SAACW,EAAA,EAAD,CAAYR,KAAK,eAAenC,QAASA,EAASoC,MAAOC,EAAAA,EAAAA,WAAqBxD,KAAMN,EAAO,GAAGM,WAElG,iBAAKmD,UAAU,2BAAf,WACI,6DACA,SAACC,EAAA,EAAD,CAAWC,QAAQ,aAAaC,KAAK,YAAYnC,QAASA,EAASoC,MAAOC,EAAAA,EAAAA,KAAeC,YAAY,sBAEzG,iBAAKN,UAAU,kDAAf,WACI,iBAAKA,UAAU,2BAAf,WACI,6CACA,SAACC,EAAA,EAAD,CAAWW,KAAK,SAASV,QAAQ,aAAaC,KAAK,SAASnC,QAASA,EAASoC,MAAOC,EAAAA,EAAAA,MAAgBC,YAAY,eAErH,iBAAKN,UAAU,2BAAf,WACI,oEACA,SAACC,EAAA,EAAD,CAAWW,KAAK,SAASV,QAAQ,aAAaC,KAAK,UAAUnC,QAASA,EAASoC,MAAOC,EAAAA,EAAAA,SAAmBC,YAAY,cAG7H,iBAAKN,UAAU,kDAAf,WACI,iBAAKA,UAAU,2BAAf,WACI,uDACA,SAACC,EAAA,EAAD,CAAWW,KAAK,SAASV,QAAQ,aAAaC,KAAK,gBAAgBnC,QAASA,EAASoC,MAAOC,EAAAA,EAAAA,MAAgBC,YAAY,YAE5H,iBAAKN,UAAU,2BAAf,WACI,6CACA,SAACC,EAAA,EAAD,CAAWW,KAAK,SAASV,QAAQ,aAAaC,KAAK,UAAUnC,QAASA,EAASoC,MAAOC,EAAAA,EAAAA,WAAqBC,YAAY,cAG/H,iBAAKN,UAAU,4BAAf,WACI,gDACA,SAACa,EAAA,EAAD,CAAUV,KAAK,UAAUnC,QAASA,EAASoC,MAAOC,EAAAA,EAAAA,MAAgB1B,cAAeA,QAErF,iBAAKqB,UAAU,2BAAf,WACI,mDACA,SAACc,EAAA,EAAD,CAAczE,UAAWA,YAK5C,C","sources":["webpack://frontend/./src/page/Admin/UpdateProduct/style.module.scss?502a","page/Admin/UpdateProduct/index.jsx"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"hide-scrollbar\":\"style_hide-scrollbar__jlYFl\"};","import { useForm } from \"react-hook-form\";\r\nimport Textfield from \"../../../components/Textfield\";\r\nimport DropFile from \"../../../components/DropFile\";\r\nimport { VALIDATE } from \"../../../constants/validate\";\r\nimport clsx from \"clsx\";\r\nimport { useCallback, useEffect } from \"react\";\r\nimport { useState } from \"react\";\r\nimport style from \"./style.module.scss\";\r\nimport PreviewImage from \"../../../components/PreviewImage\";\r\nimport MenuSelect from \"../../../components/MenuSelect\";\r\nimport { useQueries, useQuery } from \"react-query\";\r\nimport axiosJWT from \"../../../config/axiosJWT\";\r\nimport { API } from \"../../../constants/api\";\r\nimport Loading from \"../../../components/Loading\";\r\nimport { useLocation } from \"react-router-dom\";\r\n\r\nfunction UpdateProduct() {\r\n    const { state } = useLocation();\r\n    const [fileImage, setFileImage] = useState();\r\n    const result = useQueries([\r\n        {\r\n            queryKey: [\"category\"],\r\n            queryFn: async () => {\r\n                const result = await axiosJWT.get(API.GET_LIST_ALL_CATEGORY);\r\n                return result.data;\r\n            },\r\n            keepPreviousData: true,\r\n            staleTime: 5000\r\n        },\r\n        {\r\n            queryKey: [\"publishing company\"],\r\n            queryFn: async () => {\r\n                const result = await axiosJWT.get(API.GET_LIST_ALL_PUBLISHING);\r\n                return result.data;\r\n            },\r\n            keepPreviousData: true,\r\n            staleTime: 5000\r\n        },\r\n        {\r\n            queryKey: [\"authors\"],\r\n            queryFn: async () => {\r\n                const result = await axiosJWT.get(API.AUTHOR);\r\n                return result.data;\r\n            },\r\n            keepPreviousData: true,\r\n            staleTime: 5000\r\n        }\r\n    ]);\r\n    const { register, control, formState: { errors }, handleSubmit, setValue, trigger, watch } = useForm({\r\n        mode: \"onBlur\",\r\n        defaultValues: {\r\n            TenSanPham: state?.TenSanPham ? state?.TenSanPham : \"\",\r\n            TomTatND: state?.TomTatND ? state?.TomTatND : \"\",\r\n            IDDanhMuc: state?.IDDanhMuc ? state?.IDDanhMuc : \"\",\r\n            IDTheLoai: state?.IDTheLoai ? state?.IDTheLoai : \"\",\r\n            IDNhaXuatBan: state?.IDNhaXuatBan ? state?.IDNhaXuatBan : \"\",\r\n            GiaBan: state?.GiaBan ? state?.GiaBan : \"\",\r\n            IDTacGia: state?.IDTacGia ? state?.IDTacGia : \"\",\r\n            GiamGia: state?.GiamGia ? state?.GiamGia : \"\",\r\n            SoTrang: state?.SoTrang ? state?.SoTrang : \"\",\r\n            SoLuongConLai: state?.SoLuongConLai ? state?.SoLuongConLai : \"\",\r\n            DonViTinh: state?.DonViTinh ? state?.DonViTinh : \"\",\r\n            HinhAnh: state?.HinhAnh ? state?.HinhAnh : \"\",\r\n        }\r\n    });\r\n\r\n    const { data: typeOfBook, isLoading, isError } = useQuery({\r\n        queryKey: [\"type of product\", watch(\"IDDanhMuc\")],\r\n        queryFn: async () => {\r\n            if (watch(\"IDDanhMuc\")) {\r\n                const result = await axiosJWT.get(`${API.GET_LIST_ALL_TYPEOF_BOOK}/${watch(\"IDDanhMuc\")}`)\r\n                return result.data;\r\n            }\r\n            return []\r\n        },\r\n        keepPreviousData: true\r\n    });\r\n\r\n    const onChangeImage = useCallback(async (e) => {\r\n        const fileImageFolder = e.target.files[0];\r\n        if (fileImageFolder) {\r\n            setValue(\"HinhAnh\", fileImageFolder);\r\n            if (await trigger(\"HinhAnh\")) {\r\n                const fileReader = new FileReader();\r\n                fileReader.readAsDataURL(fileImageFolder)\r\n                fileReader.onloadend = () => {\r\n                    setFileImage(fileReader.result);\r\n                }\r\n            } else setFileImage(null);\r\n        }\r\n    }, []);\r\n    const onSubmit = useCallback(async (data) => {\r\n        const { IDDanhMuc, ...rest } = data;\r\n        try {\r\n            await axiosJWT.put(`${API.CREATE_PRODUCT}/${state?.IDSanPham}`, rest, { headers: { 'Content-Type': 'multipart/form-data' } });\r\n            window.alert(\"Cập nhật sản phẩm thành công\");\r\n        } catch (error) {\r\n            console.log(error);\r\n            window.alert(\"Cập nhật sản phẩm thất bại\");\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (state?.HinhAnh !== null) {\r\n            setFileImage(state?.HinhAnh);\r\n        }\r\n    }, [])\r\n\r\n    for (const value of result) {\r\n        if (value.isLoading) {\r\n            return <Loading />\r\n        }\r\n        if (value.isError) {\r\n            return <div>Đã có lỗi khi lấy dữ liệu 😥</div>\r\n        }\r\n    }\r\n\r\n    if (isLoading) {\r\n        return <Loading />\r\n    }\r\n    if (isError) {\r\n        return <div>Đã có lỗi khi lấy dữ liệu 😥</div>\r\n    }\r\n\r\n    return (\r\n        <form onSubmit={handleSubmit(onSubmit)}>\r\n            <div className=\"flex\">\r\n                <h2 className=\"text-xl font-semibold\">Cập Nhật Sản phẩm</h2>\r\n                <button className=\"px-3 py-1 bg-orange-600 rounded-sm text-white text-sm hover:bg-orange-500 transition-colors ml-auto\">Xác nhận</button>\r\n            </div>\r\n            <div className=\"grid sm:grid-cols-5 grid-cols-1 grid-flow-dense py-2 gap-4\">\r\n                <div className=\"col-span-1 sm:col-span-3\">\r\n                    <span>Tên sản phẩm</span>\r\n                    <Textfield rounded=\"rounded-sm\" name=\"TenSanPham\" control={control} rules={VALIDATE.name} placeholder=\"Truyện cười Việt Nam...\" />\r\n                </div>\r\n                <div className=\"col-span-1 sm:col-span-3 row-span-2\">\r\n                    <span>Nội dung</span>\r\n                    <textarea {...register(\"TomTatND\", VALIDATE.content)} className={clsx(errors.TomTatND && \"border-red-600\", style[\"hide-scrollbar\"], \"outline-none p-4 w-full border resize-none overflow-scroll\")} rows=\"6\" placeholder=\"Mô tả sản phẩm...\"></textarea>\r\n                    {errors.TomTatND && <span className=\"px-2 italic text-sm text-red-500\">{errors.TomTatND.message}*</span>}\r\n                </div>\r\n                <div className=\"col-span-1 sm:col-span-3\">\r\n                    <span>Tác giả</span>\r\n                    <MenuSelect name=\"IDTacGia\" control={control} rules={VALIDATE.author} data={result[2].data} />\r\n                </div>\r\n                <div className=\"col-span-1 sm:col-span-2\">\r\n                    <span>Danh mục</span>\r\n                    <MenuSelect name=\"IDDanhMuc\" control={control} rules={VALIDATE.category} data={result[0].data} />\r\n                </div>\r\n                <div className=\"col-span-1 sm:col-span-2\">\r\n                    <span>Thể loại</span>\r\n                    <MenuSelect name=\"IDTheLoai\" control={control} rules={VALIDATE.typeof} data={typeOfBook} />\r\n                </div>\r\n                <div className=\"col-span-1 sm:col-span-2\">\r\n                    <span>Nhà xuất bản</span>\r\n                    <MenuSelect name=\"IDNhaXuatBan\" control={control} rules={VALIDATE.publishing} data={result[1].data} />\r\n                </div>\r\n                <div className=\"col-span-1 sm:col-span-2\">\r\n                    <span>Đơn vị tính</span>\r\n                    <Textfield rounded=\"rounded-sm\" name=\"DonViTinh\" control={control} rules={VALIDATE.unit} placeholder=\"VD: Cuốn\" />\r\n                </div>\r\n                <div className=\"col-span-1 sm:col-span-3 grid grid-cols-2 gap-4\">\r\n                    <div className=\"col-span-2 sm:col-span-1\">\r\n                        <span>Giá bán</span>\r\n                        <Textfield type=\"number\" rounded=\"rounded-sm\" name=\"GiaBan\" control={control} rules={VALIDATE.price} placeholder=\"120000\" />\r\n                    </div>\r\n                    <div className=\"col-span-2 sm:col-span-1\">\r\n                        <span>Phần trăm giảm giá</span>\r\n                        <Textfield type=\"number\" rounded=\"rounded-sm\" name=\"GiamGia\" control={control} rules={VALIDATE.discount} placeholder=\"10\" />\r\n                    </div>\r\n                </div>\r\n                <div className=\"col-span-1 sm:col-span-2 grid grid-cols-2 gap-4\">\r\n                    <div className=\"col-span-2 sm:col-span-1\">\r\n                        <span>Số lượng</span>\r\n                        <Textfield type=\"number\" rounded=\"rounded-sm\" name=\"SoLuongConLai\" control={control} rules={VALIDATE.count} placeholder=\"120\" />\r\n                    </div>\r\n                    <div className=\"col-span-2 sm:col-span-1\">\r\n                        <span>Số Trang</span>\r\n                        <Textfield type=\"number\" rounded=\"rounded-sm\" name=\"SoTrang\" control={control} rules={VALIDATE.numberPage} placeholder=\"10\" />\r\n                    </div>\r\n                </div>\r\n                <div className=\"col-span-1 sm:col-span-3 \">\r\n                    <span>Hình ảnh</span>\r\n                    <DropFile name=\"HinhAnh\" control={control} rules={VALIDATE.image} onChangeImage={onChangeImage} />\r\n                </div>\r\n                <div className=\"col-span-1 sm:col-span-2\">\r\n                    <span>Xem Trước</span>\r\n                    <PreviewImage fileImage={fileImage} />\r\n                </div>\r\n            </div>\r\n        </form>\r\n    );\r\n}\r\n\r\nexport default UpdateProduct;\r\n"],"names":["state","useLocation","useState","fileImage","setFileImage","result","useQueries","queryKey","queryFn","axiosJWT","API","data","keepPreviousData","staleTime","useForm","mode","defaultValues","TenSanPham","TomTatND","IDDanhMuc","IDTheLoai","IDNhaXuatBan","GiaBan","IDTacGia","GiamGia","SoTrang","SoLuongConLai","DonViTinh","HinhAnh","register","control","errors","formState","handleSubmit","setValue","trigger","watch","useQuery","typeOfBook","isLoading","isError","onChangeImage","useCallback","e","fileImageFolder","target","files","fileReader","FileReader","readAsDataURL","onloadend","onSubmit","rest","IDSanPham","headers","window","alert","console","log","useEffect","value","Loading","className","Textfield","rounded","name","rules","VALIDATE","placeholder","clsx","style","rows","message","MenuSelect","type","DropFile","PreviewImage"],"sourceRoot":""}